import base64
from binascii import unhexlify
import gmpy2

def private_key(p, q, e):
    version = 0
    n = p*q
    d = gmpy2.invert(e, (p - 1) * (q - 1))
    exponent1 = d % (p - 1)
    exponent2 = d % (q - 1)
    coefficient = gmpy2.invert(q, p)
    sequence = encode_int(version) + encode_int(n) + encode_int(e) + encode_int(d) + encode_int(p) + encode_int(q) + encode_int(exponent1) + encode_int(exponent2) + encode_int(coefficient)
    #print(private_key)
    private_key = '30' + encode_length(len(sequence) // 2) + sequence
    print(private_key)
    print(sequence)
    print(base64.b64encode(bytearray.fromhex(private_key)))

def _hex(integer):
    val = hex(integer)[2:]
    if len(val) % 2 == 0:
        return val
    val = '0' * (len(val) % 2) + val
    return val

def encode_length(l):
    length = _hex(l)
    if l >= 80:
        length = '8' + str(len(_hex(l))) + length
    return length

def encode_int(i):
    type = '02'
    value = _hex(i)
    if int(value[0], 16) >= 8:
        value = '00' + value
    length = encode_length(len(value) // 2)
    return type + length + value

private_key(153654067345173519063152764593898887941847778866643857133324125539081576159222302163504563431415767925517478523801085695515805402234093964106382883616112560699608649630200301476104649443487068763537209861744915023867264470075932905999078280775685899539740289632802762703588979528170419262521108169901585305687,
            96301784982268189923804491853083184485939466907363961207488354346647468640551402017823499423771418049927310939917755624693369549542757092070242852871459812828100540761920414458518545727049809649579679722065104556549642048862559459838218808059350594404857985785136943579724448705218378893632294170531647115967,
            65537)

#print(encode_int(161863091426469985001358176493540241719547661391527305133576978132107887717901972545655469921112454527920502763568908799229786534949082469136818503316047702610019730504769581772016806386178260077157969035841180863069299401978140025225333279044855057641079117234814239380100022886557142183337228046784055073741))

#integer = 141200904527031427693111569572085332763291092089246046288015799505524112848666951727490655634310664507006287247690643568683363763333057271478359004846665350192723231859612961899401338906920115912147935812300211873100787356909246033420333758668256600284274201300130421437978238102757977633689474423065331072603

#print(encode_int(integer))